var globalThis=this,global=this;function __skpm_run(key,context){globalThis.context=context;try{var exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t){e.exports={JS_BRIDGE:"__skpm_sketchBridge",JS_BRIDGE_RESULT_SUCCESS:"__skpm_sketchBridge_success",JS_BRIDGE_RESULT_ERROR:"__skpm_sketchBridge_error",START_MOVING_WINDOW:"__skpm_startMovingWindow",EXECUTE_JAVASCRIPT:"__skpm_executeJS",EXECUTE_JAVASCRIPT_SUCCESS:"__skpm_executeJS_success_",EXECUTE_JAVASCRIPT_ERROR:"__skpm_executeJS_error_"}},function(e,t,n){var i=NSThread.mainThread().threadDictionary();e.exports.getWebview=function(e){return n(2).fromId(e)},e.exports.isWebviewPresent=function(e){return!!i[e]},e.exports.sendToWebview=function(t,n){if(e.exports.isWebviewPresent(t)){for(var r=null,o=i[t].contentView().subviews(),a=0;a<o.length;a+=1)r||o[a].isKindOfClass(WKInspectorWKWebView)||!o[a].isKindOfClass(WKWebView)||(r=o[a]);if(!r||!r.evaluateJavaScript_completionHandler)throw new Error("Webview "+t+" not found");r.evaluateJavaScript_completionHandler(n,null)}}},function(e,t,n){var i=n(3),r=n(9),o=n(10),a=n(11),s=n(12),l=n(13),c=n(14),u=n(4),d=n(15);function h(e){var t=(e=e||{}).identifier||String(NSUUID.UUID().UUIDString()),n=NSThread.mainThread().threadDictionary(),f=h.fromId(t);if(f)return f;var p=new i;if(p.id=t,e.modal&&!e.parent)throw new Error("A modal needs to have a parent.");var g=coscript.createFiber(),m=e.width||800,w=e.height||600,y=NSScreen.screens().firstObject().frame(),S=NSMakeRect(void 0!==e.x?e.x:Math.round((NSWidth(y)-m)/2),void 0!==e.y?NSHeight(y)-e.y:Math.round((NSHeight(y)-w)/2),m,w);e.titleBarStyle&&"default"!==e.titleBarStyle&&(e.frame=!1);var v="textured"!==e.windowType,b=NSTitledWindowMask;!1!==e.minimizable&&(b|=NSMiniaturizableWindowMask),!1!==e.closable&&(b|=NSClosableWindowMask),!1!==e.resizable&&(b|=NSResizableWindowMask),v&&!e.transparent&&!1!==e.frame||(b|=NSTexturedBackgroundWindowMask);var M=NSPanel.alloc().initWithContentRect_styleMask_backing_defer(S,b,NSBackingStoreBuffered,!0),x=WKWebViewConfiguration.alloc().init(),_=WKWebView.alloc().initWithFrame_configuration(CGRectMake(0,0,e.width||800,e.height||600),x);if(l(_),_.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),r(p,M,_),o(p,M,_),d(p,M,_,e),"desktop"===e.windowType&&(M.setLevel(kCGDesktopWindowLevel-1),M.setCollectionBehavior(NSWindowCollectionBehaviorCanJoinAllSpaces|NSWindowCollectionBehaviorStationary|NSWindowCollectionBehaviorIgnoresCycle)),void 0===e.minWidth&&void 0===e.minHeight||p.setMinimumSize(e.minWidth||0,e.minHeight||0),void 0===e.maxWidth&&void 0===e.maxHeight||p.setMaximumSize(e.maxWidth||1e4,e.maxHeight||1e4),e.transparent||!1===e.frame){M.titlebarAppearsTransparent=!0,M.titleVisibility=NSWindowTitleHidden,M.setOpaque(0),M.isMovableByWindowBackground=!0;var N=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");N.setShowsBaselineSeparator(!1),M.setToolbar(N)}if("hiddenInset"===e.titleBarStyle){var C=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");C.setShowsBaselineSeparator(!1),M.setToolbar(C)}!1!==e.frame&&e.useContentSize||p.setSize(m,w),e.center&&p.center(),e.alwaysOnTop&&p.setAlwaysOnTop(!0),e.fullscreen&&p.setFullScreen(!0),p.setFullScreenable(!!e.fullscreenable);let W=e.title;!1===e.frame?W=void 0:void 0===W&&"undefined"!=typeof __command&&__command.pluginBundle()&&(W=__command.pluginBundle().name()),W&&p.setTitle(W);var k=e.backgroundColor;e.transparent&&(k=NSColor.clearColor()),!k&&!1===e.frame&&e.vibrancy&&(k=NSColor.clearColor()),p._setBackgroundColor(k||NSColor.windowBackgroundColor()),!1===e.hasShadow&&p.setHasShadow(!1),void 0!==e.opacity&&p.setOpacity(e.opacity),e.webPreferences=e.webPreferences||{},_.configuration().preferences().setValue_forKey(!1!==e.webPreferences.devTools,"developerExtrasEnabled"),_.configuration().preferences().setValue_forKey(!1!==e.webPreferences.javascript,"javaScriptEnabled"),_.configuration().preferences().setValue_forKey(!!e.webPreferences.plugins,"plugInsEnabled"),_.configuration().preferences().setValue_forKey(e.webPreferences.minimumFontSize||0,"minimumFontSize"),e.webPreferences.zoomFactor&&_.setMagnification(e.webPreferences.zoomFactor);var R=M.contentView();return!1!==e.frame?(_.setFrame(R.bounds()),R.addSubview(_)):(R.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),a(R,R.superview()),_.setFrame(R.bounds()),R.addSubview(_),M.standardWindowButton(NSWindowFullScreenButton)&&M.standardWindowButton(NSWindowFullScreenButton).setHidden(!0),e.titleBarStyle&&"default"!==e.titleBarStyle||(M.standardWindowButton(NSWindowZoomButton).setHidden(!0),M.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),M.standardWindowButton(NSWindowCloseButton).setHidden(!0),M.standardWindowButton(NSWindowZoomButton).setEnabled(!1))),e.vibrancy&&p.setVibrancy(e.vibrancy),p.setMaximizable(!1!==e.maximizable),M.setHidesOnDeactivate(!1!==e.hidesOnDeactivate),e.remembersWindowFrame&&(M.setFrameAutosaveName(t),M.setFrameUsingName_force(M.frameAutosaveName(),!1)),e.acceptsFirstMouse&&p.on("focus",(function(e){e.type()===NSEventTypeLeftMouseDown&&p.webContents.executeJavaScript(s(_,e)).catch(()=>{})})),u.injectScript(_),c.injectScript(_),c.setupHandler(p),!1!==e.show&&p.show(),p.on("closed",(function(){p._destroyed=!0,n.removeObjectForKey(t);var e=n[t+".themeObserver"];e&&(NSApplication.sharedApplication().removeObserver_forKeyPath(e,"effectiveAppearance"),n.removeObjectForKey(t+".themeObserver")),g.cleanup()})),n[t]=M,g.onCleanup((function(){p._destroyed||p.destroy()})),p}h.fromId=function(e){var t=NSThread.mainThread().threadDictionary();if(t[e])return h.fromPanel(t[e],e)},h.fromPanel=function(e,t){var n=new i;if(n.id=t,!e||!e.contentView)throw new Error("needs to pass an NSPanel");for(var a=null,s=e.contentView().subviews(),l=0;l<s.length;l+=1)a||s[l].isKindOfClass(WKInspectorWKWebView)||!s[l].isKindOfClass(WKWebView)||(a=s[l]);if(!a)throw new Error("The panel needs to have a webview");return r(n,e,a),o(n,e,a),n},e.exports=h},function(e,t){e.exports=require("events")},function(e,t,n){(function(t){var i=n(0);e.exports=function(n,r){return function o(a,s,l){"function"==typeof s&&(l=s,s=!1);var c=coscript.createFiber();return n.navigationDelegate().state&&0==n.navigationDelegate().state.wasReady?new t((function(e,t){r.once("ready-to-show",(function(){o(a,s,l).then(e).catch(t),c.cleanup()}))})):new t((function(t,o){var s=Math.random();r.webContents.on(i.EXECUTE_JAVASCRIPT_SUCCESS+s,(function(e){try{l&&l(null,e),t(e)}catch(n){o(n)}c.cleanup()})),r.webContents.on(i.EXECUTE_JAVASCRIPT_ERROR+s,(function(e){try{l?(l(e),t()):o(e)}catch(n){o(n)}c.cleanup()})),n.evaluateJavaScript_completionHandler(e.exports.wrapScript(a,s),null)}))}},e.exports.wrapScript=function(e,t){return"window."+i.EXECUTE_JAVASCRIPT+"("+t+", "+JSON.stringify(e)+")"},e.exports.injectScript=function(e){var t="window."+i.EXECUTE_JAVASCRIPT+' = function(id, script) {  try {    var res = eval(script);    if (res && typeof res.then === "function" && typeof res.catch === "function") {      res.then(function (res2) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res2);      })      .catch(function (err) {        window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);      })    } else {      window.postMessage("'+i.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res);    }  } catch (err) {    window.postMessage("'+i.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);  }}',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}}).call(this,n(5))},function(e,t){function n(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function r(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void a(t.promise,r)}o(t.promise,i)}else(1===e._state?o:a)(t.promise,e._value)}))):e._deferreds.push(t)}function o(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void c(n.bind(t),e)}e._state=1,e._value=t,s(e)}catch(r){a(e,r)}}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value,e)}));for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e((function(e){n?i._multipleResolvesFn("resolve",t,e):(n=!0,o(t,e))}),(function(e){n?i._multipleResolvesFn("reject",t,e):(n=!0,a(t,e))}))}catch(r){if(n)return void i._multipleResolvesFn("reject",t,r);n=!0,a(t,r)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var i=new this.constructor(n);return r(this,new l(e,t,i)),i},i.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},i.all=function(e){return new i((function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var r=i.length;function o(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){o(e,t)}),n)}i[e]=a,0==--r&&t(i)}catch(l){n(l)}}for(var a=0;a<i.length;a++)o(a,i[a])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){if(!Array.isArray(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)i.resolve(e[r]).then(t,n)}))},i._immediateFn=setImmediate,i._unhandledRejectionFn=function(e,t){"undefined"!=typeof process&&process.listenerCount&&(process.listenerCount("unhandledRejection")||process.listenerCount("uncaughtException"))?(process.emit("unhandledRejection",e,t),process.emit("uncaughtException",e,"unhandledRejection")):"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._multipleResolvesFn=function(e,t,n){"undefined"!=typeof process&&process.emit&&process.emit("multipleResolves",e,t,n)},e.exports=i},function(e,t){e.exports=require("sketch")},function(e,t){e.exports=require("sketch/settings")},function(e,t){e.exports=require("sketch/ui")},function(e,t){e.exports=function(e,t,n){function i(n){e.isVisible()&&(n?(NSApplication.sharedApplication().activateIgnoringOtherApps(!0),t.makeKeyAndOrderFront(null)):(t.orderBack(null),NSApp.mainWindow().makeKeyAndOrderFront(null)))}e._panel=t,e._webview=n,e._destroyed=!1,e.destroy=function(){return t.close()},e.close=function(){if(t.delegate().utils&&t.delegate().utils.parentWindow){var n=!0;return e.emit("close",{get defaultPrevented(){return!n},preventDefault:function(){n=!1}}),void(n&&t.delegate().utils.parentWindow.endSheet(t))}e.isClosable()&&t.performClose(null)},e.focus=i.bind(this,!0),e.blur=i.bind(this,!1),e.isFocused=function(){return t.isKeyWindow()},e.isDestroyed=function(){return e._destroyed},e.show=function(){return NSApp.activateIgnoringOtherApps(!0),t.delegate().utils&&t.delegate().utils.parentWindow?t.delegate().utils.parentWindow.beginSheet_completionHandler(t,__mocha__.createBlock_function("v16@?0q8",(function(){e.emit("closed")}))):t.makeKeyAndOrderFront(null)},e.showInactive=function(){return t.orderFrontRegardless()},e.hide=function(){return t.orderOut(null)},e.isVisible=function(){return t.isVisible()},e.isModal=function(){return!1},e.maximize=function(){e.isMaximized()||t.zoom(null)},e.unmaximize=function(){e.isMaximized()&&t.zoom(null)},e.isMaximized=function(){if(0!=(t.styleMask()&NSResizableWindowMask))return t.isZoomed();var e=NSScreen.mainScreen().visibleFrame(),n=t.frame();return e.origin.x==n.origin.x&&e.origin.y==n.origin.y&&e.size.width==n.size.width&&e.size.height==n.size.height},e.minimize=function(){return t.miniaturize(null)},e.restore=function(){return t.deminiaturize(null)},e.isMinimized=function(){return t.isMiniaturized()},e.setFullScreen=function(n){n!==e.isFullscreen()&&t.toggleFullScreen(null)},e.isFullscreen=function(){return t.styleMask()&NSFullScreenWindowMask},e.setAspectRatio=function(e){e>0?t.setAspectRatio(NSMakeSize(e,1)):t.setResizeIncrements(NSMakeSize(1,1))},e.setBounds=function(n,i){if(!n)return;if(e.isFullscreen())return;const r=Object.assign(e.getBounds(),n);var o=NSMakeRect(r.x,0,r.width,r.height),a=NSScreen.screens().firstObject();o.origin.y=NSHeight(a.frame())-r.y,t.setFrame_display_animate(o,!0,i)},e.getBounds=function(){const e=t.frame();var n=NSScreen.screens().firstObject().frame();return{x:e.origin.x,y:Math.round(NSHeight(n)-e.origin.y),width:e.size.width,height:e.size.height}},e.setContentBounds=function(t,n){e.setBounds(t,n)},e.getContentBounds=function(){return e.getBounds()},e.setSize=function(t,n,i){return e.setBounds({width:t,height:n},i)},e.getSize=function(){var t=e.getBounds();return[t.width,t.height]},e.setContentSize=function(t,n,i){return e.setContentBounds({width:t,height:n},i)},e.getContentSize=function(){var t=e.getContentBounds();return[t.width,t.height]},e.setMinimumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMinSize(i)},e.getMinimumSize=function(){const e=t.contentMinSize();return[e.width,e.height]},e.setMaximumSize=function(e,n){const i=CGSizeMake(e,n);t.setContentMaxSize(i)},e.getMaximumSize=function(){const e=t.contentMaxSize();return[e.width,e.height]},e.setResizable=function(t){return e._setStyleMask(t,NSResizableWindowMask)},e.isResizable=function(){return t.styleMask()&NSResizableWindowMask},e.setMovable=function(e){return t.setMovable(e)},e.isMovable=function(){return t.isMovable()},e.setMinimizable=function(t){return e._setStyleMask(t,NSMiniaturizableWindowMask)},e.isMinimizable=function(){return t.styleMask()&NSMiniaturizableWindowMask},e.setMaximizable=function(e){t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).setEnabled(e)},e.isMaximizable=function(){return t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).isEnabled()},e.setFullScreenable=function(t){e._setCollectionBehavior(t,NSWindowCollectionBehaviorFullScreenPrimary),e._setCollectionBehavior(!t,NSWindowCollectionBehaviorFullScreenAuxiliary)},e.isFullScreenable=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorFullScreenPrimary},e.setClosable=function(t){e._setStyleMask(t,NSClosableWindowMask)},e.isClosable=function(){return t.styleMask()&NSClosableWindowMask},e.setAlwaysOnTop=function(e,n,i){var r=NSNormalWindowLevel,o=CGWindowLevelForKey(kCGMaximumWindowLevelKey),a=CGWindowLevelForKey(kCGMinimumWindowLevelKey);e&&(r="normal"===n?NSNormalWindowLevel:"torn-off-menu"===n?NSTornOffMenuWindowLevel:"modal-panel"===n?NSModalPanelWindowLevel:"main-menu"===n?NSMainMenuWindowLevel:"status"===n?NSStatusWindowLevel:"pop-up-menu"===n?NSPopUpMenuWindowLevel:"screen-saver"===n?NSScreenSaverWindowLevel:"dock"===n?NSDockWindowLevel:NSFloatingWindowLevel);var s=r+(i||0);if(!(s>=a&&s<=o))throw new Error("relativeLevel must be between "+a+" and "+o);t.setLevel(s)},e.isAlwaysOnTop=function(){return t.level()!==NSNormalWindowLevel},e.moveTop=function(){return t.orderFrontRegardless()},e.center=function(){t.center()},e.setPosition=function(t,n,i){return e.setBounds({x:t,y:n},i)},e.getPosition=function(){var t=e.getBounds();return[t.x,t.y]},e.setTitle=function(e){t.setTitle(e)},e.getTitle=function(){return String(t.title())};var r=0;e.flashFrame=function(e){e?r=NSApp.requestUserAttention(NSInformationalRequest):(NSApp.cancelUserAttentionRequest(r),r=0)},e.getNativeWindowHandle=function(){return t},e.getNativeWebViewHandle=function(){return n},e.loadURL=function(e){if(/^(?!https?|file).*\.html?$/.test(e)&&"undefined"!=typeof __command&&__command.pluginBundle()&&(e="file://"+__command.pluginBundle().urlForResourceNamed(e).path()),/^file:\/\/.*\.html?$/.test(e))return e=(e=NSString.alloc().initWithString(e)).stringByAddingPercentEncodingWithAllowedCharacters(NSCharacterSet.URLQueryAllowedCharacterSet()),void n.loadFileURL_allowingReadAccessToURL(NSURL.URLWithString(e),NSURL.URLWithString("file:///"));const t=NSURL.URLWithString(e),i=NSURLRequest.requestWithURL(t);n.loadRequest(i)},e.reload=function(){n.reload()},e.setHasShadow=function(e){return t.setHasShadow(e)},e.hasShadow=function(){return t.hasShadow()},e.setOpacity=function(e){return t.setAlphaValue(e)},e.getOpacity=function(){return t.alphaValue()},e.setVisibleOnAllWorkspaces=function(t){return e._setCollectionBehavior(t,NSWindowCollectionBehaviorCanJoinAllSpaces)},e.isVisibleOnAllWorkspaces=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorCanJoinAllSpaces},e.setIgnoreMouseEvents=function(e){return t.setIgnoresMouseEvents(e)},e.setContentProtection=function(e){t.setSharingType(e?NSWindowSharingNone:NSWindowSharingReadOnly)},e.setAutoHideCursor=function(e){t.setDisableAutoHideCursor(e)},e.setVibrancy=function(n){var i=e._vibrantView;if(!n){if(null==i)return;return i.removeFromSuperview(),void t.setVibrantView(null)}if(null==i){var r=t.contentView();i=NSVisualEffectView.alloc().initWithFrame(r.bounds()),e._vibrantView=i,i.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),i.setBlendingMode(NSVisualEffectBlendingModeBehindWindow),i.setState(NSVisualEffectStateActive),i.setFrame(r.bounds()),r.addSubview_positioned_relativeTo(i,NSWindowBelow,null)}var o=NSVisualEffectMaterialLight;"appearance-based"===n?o=NSVisualEffectMaterialAppearanceBased:"light"===n?o=NSVisualEffectMaterialLight:"dark"===n?o=NSVisualEffectMaterialDark:"titlebar"===n?o=NSVisualEffectMaterialTitlebar:"selection"===n?o=NSVisualEffectMaterialSelection:"menu"===n?o=NSVisualEffectMaterialMenu:"popover"===n?o=NSVisualEffectMaterialPopover:"sidebar"===n?o=NSVisualEffectMaterialSidebar:"medium-light"===n?o=NSVisualEffectMaterialMediumLight:"ultra-dark"===n&&(o=NSVisualEffectMaterialUltraDark),i.setMaterial(o)},e._setBackgroundColor=function(e){var i=function(e){if(!e||"#"!==e[0]){if(e&&"function"==typeof e.isKindOfClass&&e.isKindOfClass(NSColor))return e;throw new Error("Incorrect color formating. It should be an hex color: #RRGGBBAA")}var t,n=e.substr(1);if(3===n.length?n+="F":6===n.length&&(n+="FF"),4===n.length)for(var i=0;i<4;i+=1)t+=n[i],t+=n[i];else{if(8!==n.length)return NSColor.whiteColor();t=n}var r=parseInt(t.slice(0,2),16)/255,o=parseInt(t.slice(2,4),16)/255,a=parseInt(t.slice(4,6),16)/255,s=parseInt(t.slice(6,8),16)/255;return NSColor.colorWithSRGBRed_green_blue_alpha(r,o,a,s)}(e);n.setValue_forKey(!1,"drawsBackground"),t.backgroundColor=i},e._invalidate=function(){t.flushWindow(),t.contentView().setNeedsDisplay(!0)},e._setStyleMask=function(n,i){var r=e.isMaximizable();n?t.setStyleMask(t.styleMask()|i):t.setStyleMask(t.styleMask()&~i),e.setMaximizable(r)},e._setCollectionBehavior=function(n,i){var r=e.isMaximizable();n?t.setCollectionBehavior(t.collectionBehavior()|i):t.setCollectionBehavior(t.collectionBehavior()&~i),e.setMaximizable(r)},e._showWindowButton=function(e){var n=t.standardWindowButton(e);n.superview().addSubview_positioned_relative(n,NSWindowAbove,null)}}},function(e,t,n){var i=n(3),r=n(4);e.exports=function(e,t,n){var o=new i;o.loadURL=e.loadURL,o.loadFile=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.downloadURL=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getURL=function(){return String(n.URL())},o.getTitle=function(){return String(n.title())},o.isDestroyed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.focus=e.focus,o.isFocused=e.isFocused,o.isLoading=function(){return!!n.loading()},o.isLoadingMainFrame=function(){return!!n.loading()},o.isWaitingForResponse=function(){return!n.loading()},o.stop=function(){n.stopLoading()},o.reload=function(){n.reload()},o.reloadIgnoringCache=function(){n.reloadFromOrigin()},o.canGoBack=function(){return!!n.canGoBack()},o.canGoForward=function(){return!!n.canGoForward()},o.canGoToOffset=function(e){return!!n.backForwardList().itemAtIndex(e)},o.clearHistory=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.goBack=function(){n.goBack()},o.goForward=function(){n.goForward()},o.goToIndex=function(e){var t=n.backForwardList(),i=t.backList(),r=i.count();if(r>e)n.loadRequest(NSURLRequest.requestWithURL(i[e]));else{var o=t.forwardList();if(!(o.count()>e-r))throw new Error("Cannot go to index "+e);n.loadRequest(NSURLRequest.requestWithURL(o[e-r]))}},o.goToOffset=function(e){if(!o.canGoToOffset(e))throw new Error("Cannot go to offset "+e);n.loadRequest(NSURLRequest.requestWithURL(n.backForwardList().itemAtIndex(e)))},o.isCrashed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setUserAgent=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getUserAgent=function(){const e=n.customUserAgent();return e?String(e):void 0},o.insertCSS=function(e){var t="var style = document.createElement('style'); style.innerHTML = "+e.replace(/"/,'\\"')+"; document.head.appendChild(style);",i=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);n.configuration().userContentController().addUserScript(i)},o.insertJS=function(e){var t=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(e,0,!0);n.configuration().userContentController().addUserScript(t)},o.executeJavaScript=r(n,e),o.setIgnoreMenuShortcuts=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.isAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setZoomFactor=function(e){n.setMagnification_centeredAtPoint(e,CGPointMake(0,0))},o.getZoomFactor=function(e){e(Number(n.magnification()))},o.setZoomLevel=function(e){o.setZoomFactor(Math.pow(1.2,e))},o.getZoomLevel=function(e){e(Math.log(Number(n.magnification()))/Math.log(1.2))},o.setVisualZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setLayoutZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.send=function(){const e="window.postMessage({isSketchMessage: true,origin: '"+String(__command.identifier())+"',args: "+JSON.stringify([].slice.call(arguments))+'}, "*")';n.evaluateJavaScript_completionHandler(e,null)},o.getNativeWebview=function(){return n},e.webContents=o}},function(e,t){function n(e,t,n,i){n.addConstraint(NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(t,e,NSLayoutRelationEqual,n,e,1,i))}e.exports=function(e,t,i){i=i||[],e.setTranslatesAutoresizingMaskIntoConstraints(!1),n(NSLayoutAttributeLeft,e,t,i[0]||0),n(NSLayoutAttributeTop,e,t,i[1]||0),n(NSLayoutAttributeRight,e,t,i[2]||0),n(NSLayoutAttributeBottom,e,t,i[3]||0)}},function(e,t){e.exports=function(e,t){var n=e.convertPoint_fromView(t.locationInWindow(),null);return"var el = document.elementFromPoint("+n.x+", "+n.y+'); if (el && el.tagName === "SELECT") {  var event = document.createEvent("MouseEvents");  event.initMouseEvent("mousedown", true, true, window);  el.dispatchEvent(event);} else if (el && ["text", "textarea", "date", "datetime-local", "email", "number", "month", "password", "search", "tel", "time", "url", "week" ].indexOf(el.type) >= 0 && el.focus) {el.focus();} else if (el) {el.dispatchEvent(new Event("click", {bubbles: true}))}'}},function(e,t,n){var i=n(0);e.exports=function(e){var t='window.originalPostMessage = window.postMessage;window.postMessage = function(actionName) {  if (!actionName) {    throw new Error(\'missing action name\')  }  var id = String(Math.random()).replace(".", "");    var args = [].slice.call(arguments);    args.unshift(id);  return new Promise(function (resolve, reject) {    window["'+i.JS_BRIDGE_RESULT_SUCCESS+'" + id] = resolve;    window["'+i.JS_BRIDGE_RESULT_ERROR+'" + id] = reject;    window.webkit.messageHandlers.'+i.JS_BRIDGE+".postMessage(JSON.stringify(args));  });}",n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}},function(e,t,n){var i=n(0);e.exports.injectScript=function(e){var t='(function () {document.addEventListener(\'mousedown\', onMouseDown);function shouldDrag(target) {  if (!target || (target.dataset || {}).appRegion === "no-drag") { return false }  if ((target.dataset || {}).appRegion === "drag") { return true }  return shouldDrag(target.parentElement)};function onMouseDown(e) {  if (e.button !== 0 || !shouldDrag(e.target)) { return }  window.postMessage("'+i.START_MOVING_WINDOW+'");};})()',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)},e.exports.setupHandler=function(e){var t=null,n=null,r=null;function o(){if(!n||1!==NSEvent.pressedMouseButtons())return clearInterval(r),t=null,void(n=null);var i=NSEvent.mouseLocation();e.setPosition(n.x+(i.x-t.x),n.y+(t.y-i.y),!1)}e.webContents.on(i.START_MOVING_WINDOW,(function(){t=NSEvent.mouseLocation();var i=e.getPosition();n={x:i[0],y:i[1]},r=setInterval(o,1e3/60)}))}},function(e,t,n){(function(t){var i,r,o,a,s=n(16),l=n(17),c=n(0);e.exports=function(e,n,u,d){a||(a=new s({utils:null,"observeValueForKeyPath:ofObject:change:context:":function(e,t,n){const i=n[NSKeyValueChangeNewKey],r="NSAppearanceNameDarkAqua"===String(i.bestMatchFromAppearancesWithNames(["NSAppearanceNameAqua","NSAppearanceNameDarkAqua"]));this.utils.executeJavaScript("document.body.classList.remove('__skpm-"+(r?"light":"dark")+"'); document.body.classList.add('__skpm-"+(r?"dark":"light")+"')")}})),i||(i=new s({utils:null,panel:null,"windowDidResize:":function(){this.utils.emit("resize")},"windowDidMiniaturize:":function(){this.utils.emit("minimize")},"windowDidDeminiaturize:":function(){this.utils.emit("restore")},"windowDidEnterFullScreen:":function(){this.utils.emit("enter-full-screen")},"windowDidExitFullScreen:":function(){this.utils.emit("leave-full-screen")},"windowDidMove:":function(){this.utils.emit("move"),this.utils.emit("moved")},"windowShouldClose:":function(){var e=1;return this.utils.emit("close",{get defaultPrevented(){return!e},preventDefault:function(){e=0}}),e},"windowWillClose:":function(){this.utils.emit("closed")},"windowDidBecomeKey:":function(){this.utils.emit("focus",this.panel.currentEvent())},"windowDidResignKey:":function(){this.utils.emit("blur")}})),r||(r=new s({state:{wasReady:0},utils:null,"webView:didCommitNavigation:":function(e){this.utils.emit("will-navigate",{},String(String(e.URL())))},"webView:didStartProvisionalNavigation:":function(){this.utils.emit("did-start-navigation"),this.utils.emit("did-start-loading")},"webView:didReceiveServerRedirectForProvisionalNavigation:":function(){this.utils.emit("did-get-redirect-request")},"webView:didFailProvisionalNavigation:withError:":function(e,t,n){this.utils.emit("did-fail-load",n)},"webView:didFinishNavigation:":function(){0==this.state.wasReady&&(this.state.wasReady=1,this.utils.emitBrowserEvent("ready-to-show")),this.utils.emit("did-navigate"),this.utils.emit("did-frame-navigate"),this.utils.emit("did-stop-loading"),this.utils.emit("did-finish-load"),this.utils.emit("did-frame-finish-load")},"webViewWebContentProcessDidTerminate:":function(){this.utils.emit("dom-ready")}})),o||(o=new s({utils:null,"userContentController:didReceiveScriptMessage:":function(e,t){var n=this.utils.parseWebArguments(String(t.body()));n&&n[0]&&"string"==typeof n[0]&&(n[0]=String(n[0]),this.utils.emit.apply(this,n))}}));var h=a.new({utils:{executeJavaScript(e){u.evaluateJavaScript_completionHandler(e,null)}}}),f=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly("document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-"+("undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"dark":"light")+"') }, false)",0,!0);u.configuration().userContentController().addUserScript(f),NSApplication.sharedApplication().addObserver_forKeyPath_options_context(h,"effectiveAppearance",NSKeyValueObservingOptionNew,null),NSThread.mainThread().threadDictionary()[e.id+".themeObserver"]=h;var p=r.new({utils:{setTitle:e.setTitle.bind(e),emitBrowserEvent(){try{e.emit.apply(e,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}},emit(){try{e.webContents.emit.apply(e.webContents,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}}},state:{wasReady:0}});u.setNavigationDelegate(p);var g=o.new({utils:{emit(n,i){if(i){for(var r=[],o=2;o<arguments.length;o+=1)r.push(arguments[o]);var a=e.webContents.listeners(i);t.all(a.map((function(e){return t.resolve().then((function(){return e.apply(e,r)}))}))).then((function(e){u.evaluateJavaScript_completionHandler(c.JS_BRIDGE_RESULT_SUCCESS+n+"("+JSON.stringify(e)+")",null)})).catch((function(e){u.evaluateJavaScript_completionHandler(c.JS_BRIDGE_RESULT_ERROR+n+"("+JSON.stringify(e)+")",null)}))}else u.evaluateJavaScript_completionHandler(c.JS_BRIDGE_RESULT_SUCCESS+n+"()",null)},parseWebArguments:l}});u.configuration().userContentController().addScriptMessageHandler_name(g,c.JS_BRIDGE);var m,w={emit(){try{e.emit.apply(e,arguments)}catch(t){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw console.error(t),t;process.emit("uncaughtException",t,"uncaughtException")}}};d.modal&&((m="Document"===d.parent.type?d.parent.sketchObject:d.parent)&&"MSDocumentData"===String(m.class())&&(m=m.delegate()),w.parentWindow=m.windowForSheet());var y=i.new({utils:w,panel:n});n.setDelegate(y)}}).call(this,n(5))},function(module,exports){module.exports=function MochaDelegate(definition,superclass){var uniqueClassName="MochaJSDelegate_DynamicClass_"+NSUUID.UUID().UUIDString(),delegateClassDesc=MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName,superclass||NSObject),handlers={},ivars={};function setHandlerForSelector(selectorString,func){var handlerHasBeenSet=selectorString in handlers,selector=NSSelectorFromString(selectorString);if(handlers[selectorString]=func,!handlerHasBeenSet){for(var args=[],regex=/:/g;regex.exec(selectorString);)args.push("arg"+args.length);var dynamicFunction=eval("(function ("+args.join(", ")+") { return handlers[selectorString].apply(this, arguments); })");delegateClassDesc.addInstanceMethodWithSelector_function(selector,dynamicFunction)}}function setIvar(e,t){var n=e in handlers;if(ivars[e]=t,!n){delegateClassDesc.addInstanceVariableWithName_typeEncoding(e,"@");var i=MOPropertyDescription.new();i.name=e,i.typeEncoding="@",i.weak=!0,i.ivarName=e,delegateClassDesc.addProperty(i)}}this.getClass=function(){return NSClassFromString(uniqueClassName)},this.getClassInstance=function(e){var t=NSClassFromString(uniqueClassName).new();return Object.keys(ivars).forEach((function(e){t[e]=ivars[e]})),Object.keys(e||{}).forEach((function(n){t[n]=e[n]})),t},this.new=this.getClassInstance,"object"==typeof definition&&Object.keys(definition).forEach((function(e){"function"==typeof definition[e]?setHandlerForSelector(e,definition[e]):setIvar(e,definition[e])})),delegateClassDesc.registerClass()}},function(e,t){e.exports=function(e){var t=null;try{t=JSON.parse(e)}catch(n){}return t&&t.constructor&&t.constructor===Array&&0!=t.length?t:null}},function(e,t){e.exports="file://"+String(context.scriptPath).split(".sketchplugin/Contents/Sketch")[0]+".sketchplugin/Contents/Resources/_webpack_resources/d185e74ad4e53236afd37ba858a0bf3b.html"},function(e,t,n){"use strict";n.r(t),n.d(t,"onShutdown",(function(){return f})),n.d(t,"onSelectionChanged",(function(){return p}));var i=n(2),r=n.n(i),o=n(1);function a(e,t){this.x=e||0,this.y=t||0}Math.rad=Math.PI/180,Math.degrees=function(e){return(e+360)%360},Math.factorial=function(e){for(var t=1,n=2;n<=e;n++)t*=n;return t},Math.triangle=function(e){return e*(e+1)/2},Math.decimal=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},Math.ease=function(e,t){var n={start:0,step:0,latter:0,factor:1,points:new Array};switch(e){case"ease":n.step=Math.PI/t,n.factor=2;break;case"ease-in":n.start=Math.PI/2,n.step=Math.PI/2/t;break;case"ease-out":n.step=Math.PI/2/t}if(n.step){n.latter=(Math.cos(n.start)+1)/n.factor;for(var i=0;i<=t;i++){var r=(Math.cos(n.start)+1)/n.factor,o=0==i?0:Math.abs(r-n.latter);n.start+=n.step,n.latter=r,i&&n.points.push(o)}return n.points.push(0),n.points}return!1},Math.easePower=function(e,t,n){if("linear"==e)return!1;for(var i=new Array,r=0,o=0;o<=n;o++){var a="ease"==e&&o>n/2?Math.pow(n+1-o,t):Math.pow(o,t);o&&(r+=a,"ease-in"==e?i.unshift(a):i.push(a))}for(var s=0;s<n;s++)i[s]=Math.decimal(i[s]/=r,6);return i.push(0),i},a.prototype={add:function(e){this.x+=e.x,this.y+=e.y},angle:function(){return Math.degrees(270-180*Math.atan2(this.y,-this.x)/Math.PI)},multiplier:function(e){var t=Math.degrees(this.angle()-e),n=Math.rad*t,i=Math.decimal(Math.cos(n),9);return i},radius:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},root:function(){Math.abs(this.x)>Math.abs(this.y)?(this.y=this.y/Math.abs(this.x),this.x=this.x/Math.abs(this.x)):(this.x=this.x/Math.abs(this.y),this.y=this.y/Math.abs(this.y))},rotate:function(e,t){var n=Math.rad*t,i=Math.cos(n),r=Math.sin(n),o=this.x,a=this.y;this.x=i*(o-e.x)+r*(a-e.y)+e.x,this.y=i*(a-e.y)-r*(o-e.x)+e.y},substract:function(e){this.x-=e.x,this.y-=e.y}};var s=n(6),l=n(7),c=n(8),u=["Custom","Rectangle","Oval","Triangle","Polygon","Star"],d=["custom shape","rectangle","oval","triangle","polygon","star"],h=["loops","points","smooth","timing","power","squeeze","mirror","clockwise","auto"];t.default=function(e){var t={identifier:"comm.ddSpiral.webview",width:240,height:554,show:!1,backgroundColor:"#ffffffff",alwaysOnTop:!0,resizable:!1,titleBarStyle:"default",maximizable:!1,minimizable:!1},i=new r.a(t);i.once("ready-to-show",(function(){l.setSettingForKey("ddSpiralIDwindow",!0),i.show()})),i.once("close",(function(){l.setSettingForKey("ddSpiralIDwindow",!1)}));var o=i.webContents;o.on("did-finish-load",(function(){g()})),o.on("followLink",(function(e){NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(e))})),o.on("internalRequest",(function(e){if((e=JSON.parse(e)).action)switch(e.action){case"getSelection":g();break;case"spiralise":!function(e){var t=s.getSelectedDocument(),n=e.start_val,i=e.end_val,r=e.settings;for(var o in h)l.setSettingForKey("ddSpiralID"+h[o],r[h[o]]);var c={length:new a(n.w,n.h),step:new a,target:new a(i.w,i.h),total:0,array:[]},u={angle:Math.degrees(n.deg),step:0,target:Math.degrees(i.deg)},d={center:new a(n.x,n.y),step:0,target:new a(i.x,i.y),total:0,array:[]},f=r.loops*r.points,p=Math.easePower(r.timing,.85*r.power,f),g={first:!1,start:new a,length:0};if(r.squeeze){r.loops=Math.round(r.loops)+.5,f=r.loops*r.points,p=Math.easePower(r.timing,.85*r.power,f);for(var m=t.getLayerWithID(r.startID).sketchObject.pathInFrameWithTransforms(),w={top:!1,bottom:0,array:[]},y=0;y<=Math.round(m.length());y++){var S=m.pointOnPathAtLength(y),v=Math.round(S.x),b=Math.round(S.y);if(g.first||(g.first=new a(v,b)),v==g.start.x&&b==g.start.y&&y!=Math.round(m.length()))g.length++;else if(g.length>2||y==Math.round(m.length())){for(var M=Math.sqrt((g.first.x-g.start.x)*(g.first.x-g.start.x)+(g.first.y-g.start.y)*(g.first.y-g.start.y)),x=new a((g.first.x-g.start.x)/M,(g.first.y-g.start.y)/M),_=0;_<M;_++){var N=Math.round(g.start.x+_*x.x),C=Math.round(g.start.y+_*x.y),W=Math.ceil(w.array[C]?N>w.array[C].high?N:w.array[C].high:N),k=Math.floor(w.array[C]?N<w.array[C].low?N:w.array[C].low:N),R=(W-k)/2,O=k+R;w.array[C]={high:W,low:k,center:O,radius:R}}g.start=new a(v,b),g.length=0}else{g.start=new a(v,b),g.length=0;var E=Math.ceil(w.array[b]?v>w.array[b].high?v:w.array[b].high:v),I=Math.floor(w.array[b]?v<w.array[b].low?v:w.array[b].low:v),D=(E-I)/2,T=I+D;w.top=b<w.top||!1===w.top?b:w.top,w.bottom=b>w.bottom?b:w.bottom,w.array[b]={high:E,low:I,center:T,radius:D}}}u.angle=0,u.target=0;var B=c.length.y/(r.loops+0),F="linear"!=r.timing;(d={center:new a(w.array[w.top].center,w.top+(F&&("ease"==r.timing||"ease-out"==r.timing)?0:B)),step:0,target:new a(w.array[w.bottom].center,w.bottom-(F&&("ease"==r.timing||"ease-in"==r.timing)?0:B)),total:0,array:[]}).total=new a(d.target.x-d.center.x,d.target.y-d.center.y),d.step=new a(d.total.x/f,d.total.y/f),c={length:new a(w.array[w.top+1].radius,F&&("ease"==r.timing||"ease-out"==r.timing)?0:B),step:new a,target:new a(w.array[w.bottom].radius,F&&("ease"==r.timing||"ease-in"==r.timing)?0:B),total:0,array:[]};var P=0,A=0;for(y=0;y<=f;y++){if(p){P+=p[y]*d.total.y;var L=new a(n.x,d.center.y+P);p[y];var j=new a(c.length.x,B);F&&(A=p[y]>A?p[y]:A,j.y=p[y])}else L=new a(n.x,d.center.y+y*d.step.y),j=new a(c.length.x,B);var z=Math.round(L.y);w.array[z]&&(L.x=w.array[z].center,j.x=w.array[z].radius),d.array.push(L),c.array.push(j)}if(F)for(var U=0;U<c.array.length;U++)c.array[U].y*=B/A}var V=(r.clockwise?1:-1)*r.loops*360/f;u.step=Math.degrees(360+u.target)-Math.degrees(360+u.angle),u.step>180?u.step=-(360-u.step):u.step<-180&&(u.step=360+u.step);u.step>0&&!r.clockwise&&(u.step-=360);u.step<0&&r.clockwise&&(u.step+=360);if(u.step/=f,d.total=new a(d.target.x-d.center.x,d.target.y-d.center.y),d.step=new a(d.total.x/f,d.total.y/f),""!=r.pathID){var K=t.getLayerWithID(r.pathID).sketchObject.pathInFrameWithTransforms(),J=K.length()/f;S=K.pointOnPathAtLength(0),d.center=new a(S.x,S.y),p&&d.array.push(new a(S.x,S.y));var H=0;for(y=0;y<=f;y++){if(p){H+=p[y]*K.length();S=K.pointOnPathAtLength(H)}else S=K.pointOnPathAtLength(J*y);d.array.push(new a(S.x,S.y))}}c.total=new a(c.target.x-c.length.x,c.target.y-c.length.y),c.step=new a(c.total.x/f,c.total.y/f),c.max=new a(c.length.x,c.length.y);for(var q=NSBezierPath.bezierPath(),G=0;G<=f;G++){var Z=c.length.x>c.length.y?c.length.x:c.length.y,X=(new a(c.length.x/Z,c.length.y/Z),G*V),$=new a(Math.sin(Math.rad*X)*c.length.x,Math.cos(Math.rad*X)*-c.length.y);if($.add(d.center),$.rotate(d.center,-u.angle),r.smooth){var Q=u.step+V,Y=Math.tan(Math.PI/(360/Q*2))/3*4,ee=X+90;ee=Math.degrees(ee);var te=new a(Math.sin(Math.rad*ee)*c.length.x*Y,Math.cos(Math.rad*ee)*-c.length.y*Y),ne=c.length.x,ie=c.length.y,re=(ne-ie)*(ne-ie)/((ne+ie)*(ne+ie))*3,oe=Math.PI*(ne+ie)*(1+re/(10+Math.sqrt(4-re))),ae=Math.sqrt(te.x*te.x+te.y*te.y),se=r.loops*r.clockwise?360:-360,le=f*u.step,ce=se/(se+le),ue=ae/(oe/r.points)*ce,de=new a(0,0);(de=d.array.length?G!=Math.floor(f)?new a((d.array[G+1].x-d.array[G].x)*ue,(d.array[G+1].y-d.array[G].y)*ue):new a((d.array[G].x-d.array[G-1].x)*ue,(d.array[G].y-d.array[G-1].y)*ue):p?new a(p[G]*d.total.x*ue,p[G]*d.total.y*ue):new a(d.step.x*ue,d.step.y*ue)).rotate(new a,u.angle),te.add(de);var he=new a($.x,$.y);he.substract(d.center),he.rotate(new a,u.angle);var fe=he.angle();if(c.array.length)pe=G!=Math.floor(f)?new a((c.array[G+1].x-c.array[G].x)*ue,(c.array[G+1].y-c.array[G].y)*ue):new a((c.array[G].x-c.array[G-1].x)*ue,(c.array[G].y-c.array[G-1].y)*ue);else if(p)if(4==r.type&&r.mirror)if(G<p.length/2)var pe=new a(Math.sin(Math.rad*fe)*p[2*G]*c.total.x*2*ue,Math.cos(Math.rad*fe)*p[2*G]*-c.total.y*2*ue);else pe=new a(Math.sin(Math.rad*fe)*(-p[2*(p.length-1-G)]*c.total.x*2)*ue,Math.cos(Math.rad*fe)*(-p[2*(p.length-1-G)]*-c.total.y*2)*ue);else pe=new a(Math.sin(Math.rad*fe)*p[G]*c.total.x*ue,Math.cos(Math.rad*fe)*p[G]*-c.total.y*ue);else if(r.mirror)if(G<f/2)pe=new a(Math.sin(Math.rad*fe)*c.step.x*2*ue,Math.cos(Math.rad*fe)*-c.step.y*2*ue);else pe=new a(Math.sin(Math.rad*fe)*c.step.x*-2*ue,Math.cos(Math.rad*fe)*-c.step.y*-2*ue);else pe=new a(Math.sin(Math.rad*fe)*c.step.x*ue,Math.cos(Math.rad*fe)*-c.step.y*ue);te.add(pe),te.x*=r.smooth,te.y*=r.smooth;var ge=new a(te.x,te.y);te.add($),te.rotate($,180-u.angle)}else me=$,te=$,ge=$;G?q.curveToPoint_controlPoint1_controlPoint2(NSMakePoint($.x,$.y),NSMakePoint(me.x,me.y),NSMakePoint(te.x,te.y)):q.moveToPoint(NSMakePoint($.x,$.y));var me=new a(ge.x,ge.y);d.array.length,me.add($),me.rotate($,-u.angle),u.angle+=u.step,d.array.length?G!=Math.floor(f)&&(d.center=new a(d.array[G+1].x,d.array[G+1].y)):p?(4==r.type&&r.mirror,d.center.x+=p[G]*d.total.x,d.center.y+=p[G]*d.total.y):d.center.add(d.step),c.array.length?G!=Math.floor(f)&&(c.length=new a(c.array[G+1].x,c.array[G+1].y)):p?4==r.type&&r.mirror?G<p.length/2?(c.length.x+=p[2*G]*c.total.x*2,c.length.y+=p[2*G]*c.total.y*2):(c.length.x-=p[2*(p.length-1-G)]*c.total.x*2,c.length.y-=p[2*(p.length-1-G)]*c.total.y*2):(c.length.x+=p[G]*c.total.x,c.length.y+=p[G]*c.total.y):r.mirror?G<f/2?(c.length.x+=2*c.step.x,c.length.y+=2*c.step.y):(c.length.x-=2*c.step.x,c.length.y-=2*c.step.y):(c.length.x+=c.step.x,c.length.y+=c.step.y)}var we=MSShapePathLayer.layerWithPath(MSPath.pathWithBezierPath(q));we.style().addStylePartOfType(1).thickness=1,we.style().borderOptions().setLineCapStyle(1),l.setLayerSettingForKey(we,"ddSpiralID","spiral");var ye=l.settingForKey("ddSpiralID");if(ye){t.getLayerWithID(ye).remove()}if(l.setSettingForKey("ddSpiralID",we.objectID()),""!=r.parentID){var Se=t.getLayerWithID(r.parentID);(Se=Se.sketchObject).addLayers([we])}else(t=t.sketchObject).currentPage().addLayers([we])}(e);break;case"clear":!function(e){var t=s.getSelectedDocument(),n=e.settings;if(""!=n.pathID){t.getLayerWithID(n.pathID).remove()}if(""!=n.startID){t.getLayerWithID(n.startID).remove()}if(""!=n.endID){t.getLayerWithID(n.endID).remove()}}(e)}})),i.loadURL(n(18))};function f(){var e=Object(o.getWebview)("comm.ddSpiral.webview");e&&e.close()}function p(e){l.settingForKey("ddSpiralIDwindow")&&g()}function g(){var e=s.getSelectedDocument().selectedLayers.layers;l.setSettingForKey("ddSpiralID",!1);var t={objects:0,shapes:0,rects:0,paths:0,parentObj:!1,startObj:!1,endObj:!1},n={theme:"light",type:0,shape:"",clear:!1,isSpiral:!1,startID:"",endID:"",pathID:"",parentID:""};for(var i in h){var r=l.settingForKey("ddSpiralID"+h[i]);n[h[i]]=r||!1===r?r:"undefined"}for(var a={x:0,y:0,w:0,h:0,deg:0,worldDeg:0},f={x:0,y:0,w:0,h:0,deg:0,worldDeg:0},p=!0,g=0;g<e.length;g++){var w=e[g],y=w.shapeType;if(u.indexOf(y)>-1&&!w.closed){if(t.paths++,1==t.paths){n.isSpiral=l.layerSettingForKey(w,"ddSpiralID"),t.parentObj=w.parent,n.parentID=w.parent.id;var S=w.sketchObject,v=NSBezierPath.bezierPathWithCGPath(S.pathInFrameWithTransforms().CGPath()).length()/10;v=v>50?50:v,n.pathID=w.id,p&&(a.w=v,a.h=v,a.deg=Math.degrees(w.transform.rotation-0),f.w=v,f.h=v,f.deg=Math.degrees(w.transform.rotation-0))}}else u.indexOf(y)>-1?(t.shapes++,n.shape=d[u.indexOf(y)],"Rectangle"==y&&t.rects++):t.objects++,t.paths||(t.parentObj=w.parent,n.parentID=w.parent.id),p?(p=!1,t.startObj=w.parent,n.startID=w.id,a.x=w.frame.x+w.frame.width/2,a.y=w.frame.y+w.frame.height/2,a.w=.5*w.frame.width,a.h=.5*w.frame.height,a.deg=Math.degrees(w.transform.rotation-0),f.x=w.frame.x+w.frame.width/2,f.y=w.frame.y+w.frame.height/2,f.w=0,f.h=0,f.deg=Math.degrees(w.transform.rotation-0)):(t.endObj=w.parent,n.endID=w.id,f.x=w.frame.x+w.frame.width/2,f.y=w.frame.y+w.frame.height/2,f.w=.5*w.frame.width,f.h=.5*w.frame.height,f.deg=Math.degrees(w.transform.rotation-0))}var b=t.objects,M=t.shapes,x=t.paths,_=t.rects;n.type=0,1!=b||M||x?(b||1!=M||_||x)&&(b||1!=M||!_||x)?b+M<2&&1==x?n.type=4:b+M!=2||x?b+M+x==3&&1==x&&(n.type=4):n.type=5:n.type=2:n.type=1,t.parentObj=m(t.parentObj),t.startObj=m(t.startObj),t.endObj=m(t.endObj),a.worldDeg=t.startObj.r,f.worldDeg=t.startObj.r,5==n.type&&t.startObj&&t.endObj&&t.startObj.id!=t.endObj.id&&(a.x+=t.startObj.x,a.y+=t.startObj.y,a.deg=Math.degrees(a.deg+t.startObj.r),a.worldDeg=0,f.x+=t.endObj.x,f.y+=t.endObj.y,f.deg=Math.degrees(f.deg+t.endObj.r),f.worldDeg=0,n.parentID=""),4==n.type&&t.startObj.id&&t.startObj.id!=t.parentObj.id&&(a.x+=t.startObj.x-t.parentObj.x,a.y+=t.startObj.y-t.parentObj.y,a.deg=Math.degrees(a.deg+t.startObj.r-t.parentObj.r),a.worldDeg=t.parentObj.r,4==n.type&&t.endObj.id&&t.endObj.id!=t.parentObj.id?(f.x+=t.endObj.x-t.parentObj.x,f.y+=t.endObj.y-t.parentObj.y,f.deg=Math.degrees(f.deg+t.endObj.r-t.parentObj.r)):f.deg=a.deg,f.worldDeg=t.parentObj.r),n.theme=c.getTheme(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"internalResponse";e=JSON.stringify(e),Object(o.isWebviewPresent)("comm.ddSpiral.webview")&&Object(o.sendToWebview)("comm.ddSpiral.webview","".concat(t,"(").concat(e,")"))}({selection:n,start_val:a,end_val:f},"setSelection")}function m(e){for(var t={id:!!e.id&&e.id,x:0,y:0,r:0};e&&e.name;)t.x+=e.frame.x,t.y+=e.frame.y,t.r+=e.transform.rotation,e=e.parent;return t}}]);if("default"===key&&"function"==typeof exports)exports(context);else{if("function"!=typeof exports[key])throw new Error('Missing export named "'+key+'". Your command should contain something like `export function " + key +"() {}`.');exports[key](context)}}catch(err){if("undefined"==typeof process||!process.listenerCount||!process.listenerCount("uncaughtException"))throw err;process.emit("uncaughtException",err,"uncaughtException")}}globalThis.onRun=__skpm_run.bind(this,"default"),globalThis.onShutdown=__skpm_run.bind(this,"onShutdown"),globalThis.onSelectionChanged=__skpm_run.bind(this,"onSelectionChanged");